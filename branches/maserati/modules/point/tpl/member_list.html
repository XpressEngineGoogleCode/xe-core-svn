<include target="header.html" />
<load target="js/point_admin.js" usecdn="true" />
<div cond="$XE_VALIDATOR_MESSAGE" class="message {$XE_VALIDATOR_MESSAGE_TYPE}">
	<p>{$XE_VALIDATOR_MESSAGE}</p>
</div>
<p>{$lang->about_point_module} {$lang->point_update_desc}</p>
<!-- SEARCH -->

<table class="x_table x_table-striped x_table-hover">
	<caption>
		Total <strong>{number_format($total_count)}</strong>, Page <strong>{number_format($page)}</strong>/{number_format($total_page)}
		<form action="./" method="get" no-error-return-url="true"  class="x_pull-right"style="margin:0">
			<input type="hidden" name="module" value="{$module}" />
			<input type="hidden" name="act" value="{$act}" />
			<fieldset>
				<select name="is_admin" style="width:auto">
					<option value="" <!--@if($is_admin!='Y')-->selected="selected"<!--@end-->>{$lang->total}</option>
					<option value="Y" <!--@if($is_admin=='Y')-->selected="selected"<!--@end-->>{$lang->is_admin}</option>
				</select>
				<select name="is_denied" style="width:auto">
					<option value="" <!--@if($is_denied!='Y')-->selected="selected"<!--@end-->>{$lang->total}</option>
					<option value="Y" <!--@if($is_denied=='Y')-->selected="selected"<!--@end-->>{$lang->denied}</option>
				</select>
				<select name="selected_group_srl" style="width:auto" title="{$lang->member_group}">
					<option value="0">{$lang->member_group}</option>
					<!--@foreach($group_list as $key => $val)-->
					<option value="{$val->group_srl}" <!--@if($selected_group_srl==$val->group_srl)-->selected="selected"<!--@end-->>{$val->title}</option>
					<!--@end-->
				</select>
				<select name="search_target" title="{$lang->search_target}">
					<option value="{$identifier}" selected="selected"|cond="$search_target == $identifier">{Context::getLang($identifier)}</option>
					<!--@foreach($lang->search_target_list as $key => $val)-->
					<option value="{$key}" <!--@if($search_target==$key)-->selected="selected"<!--@end-->>{$val}</option>
					<!--@end-->
				</select>
				<span class="x_input-append">
					<input type="search" required name="search_keyword" value="{htmlspecialchars($search_keyword)}" title="{$lang->cmd_search}" style="width:100px" />
					<button type="submit" class="x_btn x_btn-inverse">{$lang->cmd_search}</button>
					<button class="x_btn" type="button" onclick="location.href='{getUrl('','module',$module,'act',$act)}';return false;">{$lang->cmd_cancel}</button>
				</span>
			</fieldset>
		</form>
	</caption>
	<thead>
		<tr>
			<th scope="col">{$lang->no}</th>
			<th scope="col">{Context::getLang($identifier)}</th>
			<th scope="col">{$lang->nick_name}</th>
			<th scope="col">{$lang->point}</th>
			<th scope="col">{$lang->level}</th>
		</tr>
	</thead>
	<tbody>
		<tr loop="$member_list => $no,$val">
			<td>{$no}</td>
			<td cond="$identifier == 'user_id'">{$val->user_id}</td>
			<td cond="$identifier != 'user_id'"><span class="masked">{$val->email_address}</span></td>
			<td><a href="#popup_menu_area" class="member_{$val->member_srl}">{$val->nick_name}</a></td>
			<td>
				<form action="./" method="get" style="margin:0">
					<input type="hidden" name="module" value="point" />
					<input type="hidden" name="member_srl" value="{$val->member_srl}" />
					<input type="number" name="orgpoint" value="{$val->point}" disabled="disabled" style="width:60px;text-align:right" />
					->
					<span class="x_input-append">
						<input type="number" id="point_{$val->member_srl}" name="point" required style="width:60px;text-align:right" />
						<input type="button" value="{$lang->cmd_update}" onclick="updatePoint({$val->member_srl})" class="x_btn" />
					</span>
				</form>
			</td>
			<td>{$val->level}</td>
		</tr>
	</tbody>
</table>

<form ruleset="updatePoint" id="updateForm" action="./" method="POST" style="margin:0">
	<input type="hidden" name="module" value="point" />
	<input type="hidden" name="act" value="procPointAdminUpdatePoint" />
    <input type="hidden" id="update_member_srl" name="member_srl" value="" />
    <input type="hidden" id="update_point" name="point" />
</form>

<div class="x_clearfix">
	<!-- PAGINATION -->
	<form cond="$page_navigation" action="./" class="x_pagination x_pull-left" no-error-return-url="true" style="margin:0">
		<input type="hidden" name="module" value="{$module}" />
		<input type="hidden" name="act" value="{$act}" />
		<input cond="$is_admin" type="hidden" name="is_admin" value="{$is_admin}" />
		<input cond="$is_denied" type="hidden" name="is_denied" value="{$is_denied}" />
		<input cond="$selected_group_srl" type="hidden" name="selected_group_srl" value="{$selected_group_srl}" />
		<input cond="$search_target" type="hidden" name="search_target" value="{$search_target}" />
		<input cond="$search_keyword" type="hidden" name="search_keyword" value="{$search_keyword}" />
		<ul>
			<li class="x_disabled"|cond="!$page || $page == 1"><a href="{getUrl('page', '')}">&laquo; {$lang->first_page}</a></li>
	
			<block cond="$page_navigation->first_page != 1 && $page_navigation->first_page + $page_navigation->page_count > $page_navigation->last_page - 1 && $page_navigation->page_count != $page_navigation->total_page">
				{@$isGoTo = true}
				<li>
					<a href="#goTo" data-toggle="#goTo" title="{$lang->cmd_go_to_page}">...</a>
					<span cond="$isGoTo" id="goTo" class="x_input-append">
						<input type="number" min="1" max="{$page_navigation->last_page}" required name="page" title="{$lang->cmd_go_to_page}" />
						<button type="submit" class="x_add-on">Go</button>
					</span>
				</li>
			</block>
	
			<!--@while($page_no = $page_navigation->getNextPage())-->
				{@$last_page = $page_no}
				<li class="x_active"|cond="$page_no == $page"><a  href="{getUrl('page', $page_no)}">{$page_no}</a></li>
			<!--@end-->
	
			<block cond="$last_page != $page_navigation->last_page && $last_page + 1 != $page_navigation->last_page">
				{@$isGoTo = true}
				<li>
					<a href="#goTo" data-toggle="#goTo" title="{$lang->cmd_go_to_page}">...</a>
					<span cond="$isGoTo" id="goTo" class="x_input-append">
						<input type="number" min="1" max="{$page_navigation->last_page}" required name="page" title="{$lang->cmd_go_to_page}" />
						<button type="submit" class="x_add-on">Go</button>
					</span>
				</li>
				
			</block>
	
			<li class="x_disabled"|cond="$page == $page_navigation->last_page"><a href="{getUrl('page', $page_navigation->last_page)}" title="{$page_navigation->last_page}">{$lang->last_page} &raquo;</a></li>
		</ul>
	</form>

	<!-- SEARCH -->
	<form action="./" method="get" no-error-return-url="true" class="x_clearfix x_pull-right" style="margin:0">
		<input type="hidden" name="module" value="{$module}" />
		<input type="hidden" name="act" value="{$act}" />
		<fieldset>
			<select name="is_admin" style="width:auto">
				<option value="" <!--@if($is_admin!='Y')-->selected="selected"<!--@end-->>{$lang->total}</option>
				<option value="Y" <!--@if($is_admin=='Y')-->selected="selected"<!--@end-->>{$lang->is_admin}</option>
			</select>
			<select name="is_denied" style="width:auto">
				<option value="" <!--@if($is_denied!='Y')-->selected="selected"<!--@end-->>{$lang->total}</option>
				<option value="Y" <!--@if($is_denied=='Y')-->selected="selected"<!--@end-->>{$lang->denied}</option>
			</select>
			<select name="selected_group_srl" style="width:auto" title="{$lang->member_group}">
				<!--@foreach($group_list as $key => $val)-->
				<option value="{$val->group_srl}" <!--@if($selected_group_srl==$val->group_srl)-->selected="selected"<!--@end-->>{$val->title}</option>
				<!--@end-->
			</select>
			<select name="search_target" title="{$lang->search_target}">
				<option value="{$identifier}" selected="selected"|cond="$search_target == $identifier">{Context::getLang($identifier)}</option>
				<!--@foreach($lang->search_target_list as $key => $val)-->
				<option value="{$key}" <!--@if($search_target==$key)-->selected="selected"<!--@end-->>{$val}</option>
				<!--@end-->
			</select>
			<span class="x_input-append">
				<input type="search" required name="search_keyword" value="{htmlspecialchars($search_keyword)}" title="{$lang->cmd_search}" style="width:100px" />
				<button type="submit" class="x_btn x_btn-inverse">{$lang->cmd_search}</button>
				<button class="x_btn" type="button" onclick="location.href='{getUrl('','module',$module,'act',$act)}';return false;">{$lang->cmd_cancel}</button>
			</span>
		</fieldset>
	</form>
</div>
