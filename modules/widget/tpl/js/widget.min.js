function getStyle(b){var a=b.getAttribute("style");if(!a){a=b.style}if(typeof(a)=="object"){a=a.cssText}a=a.replace(/\burl\s*\(\s*"(.*?)"\s*\)/i,"url('$1')");return a}function getFloat(a){return jQuery(a).css("float")}function setFloat(b,a){jQuery(b).css("float",a)}function getPadding(b,c){var a=b.getAttribute("widget_padding_"+c);if(!a||a==null){a=0}return a}var zonePageObj=null;var zoneModuleSrl=0;function doStartPageModify(b,a){zonePageObj=get_by_id(b);zoneModuleSrl=a;jQuery("#tmpPageSizeLayer").appendTo("body").hide().attr("id","pageSizeLayer").css({position:"fixed"}).before('<div class="x_modal-backdrop" />').find(">form").submit(function(){doApplyWidgetSize(this);return false});doFitBorderSize();xAddEventListener(document.getElementById("zonePageContent"),"click",doCheckWidget);xAddEventListener(document.getElementById("zonePageContent"),"mousedown",doCheckWidgetDrag);xAddEventListener(document.getElementById("zonePageContent"),"mouseover",widgetSetup)}function removeAllWidget(){if(!confirm(confirm_delete_msg)){return}restoreWidgetButtons();jQuery(zonePageObj).html("")}function getWidgetContent(c){var a="";if(typeof(c)=="undefined"||!c){c=zonePageObj}var b=null;jQuery("div.widgetOutput",c).each(function(){if(jQuery(this).parent().get(0)!=c){return}b=jQuery(this).attr("widget");switch(b){case"widgetBox":a+=getWidgetBoxCode(this,b);break;case"widgetContent":a+=getContentWidgetCode(this,b);break;default:a+=getWidgetCode(this,b);break}});return a}function getContentWidgetCode(k,f){var j=k.firstChild;var n=jQuery("div.widgetContent",k);var g="",m="",b="",a;var h=0;var d="contenteditable,id,style,src,widget,body,class,widget_width,widget_width_type,xdpx,xdpy,height,document_srl,widget_padding_left,widget_padding_right,widget_padding_top,widget_padding_bottom,hascontent";if(n.size()>0){h=jQuery(k).attr("document_srl");if(h>0){g=""}else{g=n.html()}var c=new RegExp("^("+d.replace(/,/g,"|")+")$","i");var l;for(var e=0;e<k.attributes.length;e++){if(!(a=k.attributes[e].nodeName)||!k.attributes[e].nodeValue){continue}if(c.test(a)){continue}if(!(l=k.attributes[e].nodeValue)){continue}m+=a+'="'+encodeURIComponent(l)+'" '}return'<img hasContent="true" class="zbxe_widget_output" widget="widgetContent" style="'+getStyle(k)+'" body="'+g+'" document_srl="'+h+'" widget_padding_left="'+getPadding(k,"left")+'" widget_padding_right="'+getPadding(k,"right")+'" widget_padding_top="'+getPadding(k,"top")+'" widget_padding_bottom="'+getPadding(k,"bottom")+'" '+m+" />"}else{return""}return b}function getWidgetBoxCode(h,f){var c="";for(var d=0;d<h.attributes.length;d++){if(!h.attributes[d].nodeName||!h.attributes[d].nodeValue||/^jquery[0-9]+/i.test(h.attributes[d].nodeName)){continue}var b=h.attributes[d].nodeName.toLowerCase();if(b=="widget_padding_left"||b=="widget_padding_right"||b=="widget_padding_top"||b=="widget_padding_bottom"||b=="contenteditable"||b=="id"||b=="style"||b=="src"||b=="widget"||b=="body"||b=="class"||b=="widget_width"||b=="widget_width_type"||b=="xdpx"||b=="xdpy"||b=="height"){continue}var e=h.attributes[d].nodeValue;if(!e||e=="Array"){continue}c+=b+'="'+encodeURIComponent(e)+'" '}var g;if(jQuery(".widget_inner",h).size()>0){g=jQuery(".widget_inner",h);g=g.get(0)}else{g=jQuery(".nullWidget",h).get(0)}var a=getWidgetContent(g);return'<div widget="widgetBox" style="'+getStyle(h)+'" widget_padding_left="'+getPadding(h,"left")+'" widget_padding_right="'+getPadding(h,"right")+'" widget_padding_top="'+getPadding(h,"top")+'" widget_padding_bottom="'+getPadding(h,"bottom")+'" '+c+"><div><div>"+a+"</div></div></div>"}function getWidgetCode(h,g){var b="";var e="";for(var c=0;c<h.attributes.length;c++){if(!h.attributes[c].nodeName||!h.attributes[c].nodeValue||/^jquery[0-9]+/i.test(h.attributes[c].nodeName)){continue}var a=h.attributes[c].nodeName.toLowerCase();if(a=="contenteditable"||a=="id"||a=="style"||a=="src"||a=="widget"||a=="body"||a=="class"||a=="widget_width"||a=="widget_width_type"||a=="xdpx"||a=="xdpy"||a=="height"){continue}var f=h.attributes[c].nodeValue;if(!f||f=="Array"||f=="null"){continue}b+=a+'="'+encodeURIComponent(f)+'" '}var d=h.getAttribute("style");return'<img class="zbxe_widget_output" style="'+getStyle(h)+'" widget="'+g+'" '+b+" />"}function doAddContent(b){var a=request_uri.setQuery("module","widget").setQuery("act","dispWidgetAdminAddContent").setQuery("module_srl",zoneModuleSrl).setQuery("mid",b);popopen(a,"addContent")}function doSyncPageContent(){if(opener&&opener.selectedWidget){var b=get_by_id("content_fo");var a=opener.selectedWidget;b.style.value=getStyle(opener.selectedWidget);b.widget_padding_left.value=getPadding(a,"left");b.widget_padding_right.value=getPadding(a,"right");b.widget_padding_bottom.value=getPadding(a,"bottom");b.widget_padding_top.value=getPadding(a,"top");var f=a.firstChild;while(f&&f.className!="widgetContent"){f=f.nextSibling}if(f&&f.className=="widgetContent"){if(!b.document_srl||b.document_srl.value==0){try{var c=Base64.decode(xInnerHtml(f));c=editorReplacePath(c);get_by_id("content_fo").content.value=c;xe.Editors["1"].exec("SET_IR",[c])}catch(d){}}}}if(typeof(editorStart)!="undefined"){editorStart(1,"module_srl","content",false,400)}}function addContentWidget(a){var g=a.getAttribute("editor_sequence");var i=a.mid.value;var d=a.module_srl.value;var e=a.document_srl.value;var f=editorGetContent(g);var b={editor_sequence:g,content:f,module_srl:d,document_srl:e};if(/^\s*<p>.*<\/p>\s*$/i.test(b.content)){var j=b.content.toLowerCase();var h=j.indexOf("</p>");var c=j.lastIndexOf("</p>");if(h>0&&c>0&&h==c){b.content=f=b.content.replace(/^\s*<p>|<\/p>\s*$/ig,"")}}exec_xml("widget","procWidgetInsertDocument",b,function(o,k){if(!o||o.error!="0"){return}var r=o.document_srl;var p=opener.jQuery("div.widgetOutput[widget=widgetContent][document_srl="+r+"]"),t=[];if(p.size()>0){t=p.get(0).attributes}var s='<div class="widgetOutput" style="'+a.style.value+'" widget_padding_left="'+a.widget_padding_left.value+'" widget_padding_right="'+a.widget_padding_right.value+'" widget_padding_top="'+a.widget_padding_top.value+'" widget_padding_bottom="'+a.widget_padding_bottom.value+'" document_srl="'+r+'" widget="widgetContent"><button type="button" class="widgetResize"></button><button type="button" class="widgetResizeLeft"></button><div class="widgetBorder"><div style="padding:'+a.widget_padding_top.value+"px "+a.widget_padding_right.value+"px"+a.widget_padding_bottom.value+"px"+a.widget_padding_left.value+'px"></div>'+f+'</div><div class="widgetContent" style="display:none;width:1px;height:1px;overflow:hidden;"></div></div>';var m=jQuery(s);for(var q=0,n=t.length;q<n;q++){if(!m.attr(t[q].name)){m.attr(t[q].name,t[q].value)}}s=jQuery("<div>").append(m).html();opener.doAddWidgetCode(s);window.close()},"document_srl".split(","));return false}function doAddWidgetBox(){var a='<div class="widgetOutput" style="float:left;width:100%;height:20px;" widget="widgetBox" ><button type="button" class="widgetBoxResize"></button><button type="button" class="widgetBoxResizeLeft"></button><div class="widgetBoxBorder"><div class="nullWidget" style="width:100%;height:100px;"></div></div></div>';zonePageObj.innerHTML+=a;doFitBorderSize()}function doAddWidget(d){var e=d.widget_list;var a=e.selectedIndex;var f=e.options[a].value;var c=d.module_srl.value;var b=request_uri.setQuery("module","widget").setQuery("act","dispWidgetGenerateCodeInPage").setQuery("selected_widget",f).setQuery("module_srl",c);popopen(b,"GenerateWidgetCode")}function doFitBorderSize(){}var selectedWidget=null;var writedText=null;var checkDocumentWrite=false;window.document.write=window.document.writeln=function(b){if(checkDocumentWrite){writedText=b;return}if(b.match(/^<\//)){return}if(!window.opera){b=b.replace(/&(?![#a-z0-9]+;)/g,"&")}b=b.replace(/(<[a-z]+)/g,"$1 xmlns='http://www.w3.org/1999/xhtml'");var d=jQuery("<div>").html(b)[0];var c;c=document.getElementsByTagName("*");c=c[c.length-1];var a=d.childNodes;while(a.length){c.parentNode.appendChild(a[0])}};function doAddWidgetCode(widget_code){restoreWidgetButtons();var tmp=widget_code;while(tmp.indexOf("<!--#Meta:")>-1){var pos=tmp.indexOf("<!--#Meta:");tmp=tmp.substr(pos);var eos=tmp.indexOf("-->");var cssfile=tmp.substr(10,eos-10);if(cssfile.indexOf(".js")>-1){tmp=tmp.substr(eos);continue}if(!cssfile){break}tmp=tmp.substr(eos);var cssfile=request_uri+cssfile;if(typeof(document.createStyleSheet)=="undefined"){var css='<link rel="stylesheet" href="'+cssfile+'" />';var dummy=xCreateElement("DIV");xInnerHtml(dummy,css);document.body.appendChild(dummy)}else{document.createStyleSheet(cssfile,0)}}checkDocumentWrite=true;var tmp=widget_code.toLowerCase();while(tmp.indexOf("<script")>-1){var pos=tmp.indexOf("<script");tmp=tmp.substr(pos);var length=tmp.indexOf("<\/script>")+9;var script=widget_code.substr(pos,length);script=script.replace(/^<script([^>]*)>/i,"").replace(/<\/script>$/i,"");writedText=null;try{eval(script)}catch(e){}widget_code=widget_code.substr(0,pos)+writedText+widget_code.substr(pos+length);tmp=widget_code.toLowerCase()}var dummy=xCreateElement("div");xInnerHtml(dummy,widget_code);var obj=dummy.childNodes[0];if(selectedWidget&&selectedWidget.getAttribute("widget")){var o=jQuery("div.widget_inner",selectedWidget);var n=jQuery("div.widget_inner",obj);if(n.size()==0){n=jQuery("div.nullWidget",obj)}if(o.size()==0){o=jQuery("div.nullWidget",selectedWidget)}n.html(o.html());selectedWidget.parentNode.insertBefore(obj,selectedWidget);selectedWidget.parentNode.removeChild(selectedWidget)}else{get_by_id("zonePageContent").appendChild(obj)}checkDocumentWrite=false;selectedWidget=null}function doCheckWidget(l){var n=new xEvent(l);if(!n.target){return}var j=n.target;selectedWidget=null;var d=j.parentNode;while(d){if(d.id=="pageSizeLayer"){return}d=d.parentNode}doHideWidgetSizeSetup();if(j.className=="widgetSetup"){var o=j.parentNode.parentNode;var k=o.getAttribute("widget");if(!k){return}selectedWidget=o;if(k=="widgetContent"){popopen(request_uri+"?module=widget&act=dispWidgetAdminAddContent&module_srl="+zoneModuleSrl+"&document_srl="+o.getAttribute("document_srl"),"addContent")}else{popopen(request_uri+"?module=widget&act=dispWidgetGenerateCodeInPage&selected_widget="+k+"&widgetstyle="+c,"GenerateCodeInPage")}return}else{if(j.className=="widgetStyle"){var o=j.parentNode.parentNode;var k=o.getAttribute("widget");var c=o.getAttribute("widgetstyle");if(!k){return}selectedWidget=o;popopen(request_uri+"?module=widget&act=dispWidgetStyleGenerateCodeInPage&selected_widget="+k+"&widgetstyle="+c,"GenerateCodeInPage");return}else{if(j.className=="widgetCopy"&&j.parentNode.parentNode.className=="widgetOutput"){o=j.parentNode.parentNode;restoreWidgetButtons();if(o.getAttribute("widget")=="widgetContent"&&o.getAttribute("document_srl")){var b=new Array("error","message","document_srl");var g=new Array();g.document_srl=o.getAttribute("document_srl");exec_xml("widget","procWidgetCopyDocument",g,completeCopyWidgetContent,b,g,o);return}else{var f=xCreateElement("DIV");xInnerHtml(f,xInnerHtml(o));f.widget_sequence="";f.className="widgetOutput";for(var h=0;h<o.attributes.length;h++){if(!o.attributes[h].nodeName||!o.attributes[h].nodeValue){continue}var a=o.attributes[h].nodeName.toLowerCase();var m=o.attributes[h].nodeValue;if(!m){continue}if(m&&typeof(m)=="string"){m=m.replace(/\"/ig,"&quot;")}f.setAttribute(a,m)}if(xIE4Up){f.style.cssText=o.style.cssText}o.parentNode.insertBefore(f,o)}return}else{if(j.className=="widgetSize"||j.className=="widgetBoxSize"){var o=j.parentNode.parentNode;var k=o.getAttribute("widget");if(!k){return}selectedWidget=o;doShowWidgetSizeSetup(n.pageX,n.pageY,selectedWidget);return}else{if(j.className=="widgetRemove"||j.className=="widgetBoxRemove"){var o=j.parentNode.parentNode;var k=o.getAttribute("widget");if(confirm(confirm_delete_msg)){restoreWidgetButtons();o.parentNode.removeChild(o)}return}}}}}var o=j;while(o){if(o.className=="widgetOutput"){n.cancelBubble=true;n.returnValue=false;xPreventDefault(l);xStopPropagation(l);break}o=o.parentNode}}function completeCopyWidgetContent(e,a,d,j){var g=e.document_srl;var c=xCreateElement("DIV");xInnerHtml(c,xInnerHtml(j));c.widget_sequence="";c.className="widgetOutput";for(var f=0;f<j.attributes.length;f++){if(!j.attributes[f].nodeName||!j.attributes[f].nodeValue){continue}var b=j.attributes[f].nodeName.toLowerCase();var h=j.attributes[f].nodeValue;if(!h){continue}if(h&&typeof(h)=="string"){h=h.replace(/\"/ig,"&quot;")}c.setAttribute(b,h)}j.setAttribute("document_srl",g);if(xIE4Up){c.style.cssText=j.getAttribute("style")["cssText"]}j.parentNode.insertBefore(c,j)}function completeDeleteWidgetContent(a,b,c,d){restoreWidgetButtons();d.parentNode.removeChild(d)}function doCheckWidgetDrag(c){var a=new xEvent(c);if(!a.target){return}var b=a.target;if(jQuery(b).parents("#pageSizeLayer").size()>0){return}doHideWidgetSizeSetup();if(b.className=="widgetSetup"||b.className=="widgetStyle"||b.className=="widgetCopy"||b.className=="widgetBoxCopy"||b.className=="widgetSize"||b.className=="widgetBoxSize"||b.className=="widgetRemove"||b.className=="widgetBoxRemove"){return}p_obj=b;while(p_obj){if(p_obj.className=="widgetOutput"||p_obj.className=="widgetResize"||p_obj.className=="widgetResizeLeft"||p_obj.className=="widgetBoxResize"||p_obj.className=="widgetBoxResizeLeft"){widgetDragEnable(p_obj,widgetDragStart,widgetDrag,widgetDragEnd);widgetMouseDown(c);return}p_obj=p_obj.parentNode}}function _getInt(a){if(!a||a=="null"){return 0}if(parseInt(a,10)==NaN){return 0}return parseInt(a,10)}var selectedSizeWidget=null;function doShowWidgetSizeSetup(c,a,h){var b=jQuery("#pageSizeLayer");var f=b.find(">form:first");var h=jQuery(h);if(!f.length){return}selectedSizeWidget=h[0];var d={widget_align:h.css("float"),width:h[0].style.width,height:h[0].style.height,padding_left:_getInt(h.attr("widget_padding_left")),padding_right:_getInt(h.attr("widget_padding_right")),padding_top:_getInt(h.attr("widget_padding_top")),padding_bottom:_getInt(h.attr("widget_padding_bottom")),margin_left:_getInt(h[0].style.marginLeft),margin_right:_getInt(h[0].style.marginRight),margin_top:_getInt(h[0].style.marginTop),margin_bottom:_getInt(h[0].style.marginBottom),border_top_color:transRGB2Hex(h[0].style.borderTopColor),border_top_thick:h[0].style.borderTopWidth.replace(/px$/i,""),border_top_type:h[0].style.borderTopStyle,border_bottom_color:transRGB2Hex(h[0].style.borderBottomColor),border_bottom_thick:h[0].style.borderBottomWidth.replace(/px$/i,""),border_bottom_type:h[0].style.borderBottomStyle,border_right_color:transRGB2Hex(h[0].style.borderRightColor),border_right_thick:h[0].style.borderRightWidth.replace(/px$/i,""),border_right_type:h[0].style.borderRightStyle,border_left_color:transRGB2Hex(h[0].style.borderLeftColor),border_left_thick:h[0].style.borderLeftWidth.replace(/px$/i,""),border_left_type:h[0].style.borderLeftStyle,background_color:transRGB2Hex(h[0].style.backgroundColor),background_image_url:h[0].style.backgroundImage.replace(/^url\(/i,"").replace(/\)$/i,""),background_x:0,background_y:0,background_repeat:h[0].style.backgroundRepeat};var i=h[0].style.backgroundPosition;if(i){i=i.split(" ");if(i.length==2){d.background_x=i[0];d.background_y=i[1]}}b.show();jQuery(function(m){var k=m("#pageSizeLayer");var e=m(".x_modal-backdrop");var n=m(window).width();var j=m(window).height();var l=k.width();var o=k.height();if(n>l&&j>o){e.show();k.css({position:"fixed",top:j/2-o/2+"px",left:n/2-l/2+"px",width:"700px"})}else{e.hide();k.css({position:"static",top:"auto",left:"auto",width:"auto"})}});jQuery.each(d,function(e,k){var j=f[0].elements[e];if(j){j.value=k;if(j.className.match(/\bcolor-indicator\b/)){j.style.background=j.value="#"+j.value}}if(j.tagName.toLowerCase()=="select"){if(j.selectedIndex==-1){j.selectedIndex=0}}});try{f[0].elements[0].focus()}catch(g){}}function doHideWidgetSizeSetup(){jQuery("#pageSizeLayer, .x_modal-backdrop, .jPicker.Container").hide()}jQuery(function(a){a(document).keydown(function(c){var b=a(".jPicker.Container:visible");if(c.which==27&&!b.length){doHideWidgetSizeSetup();return false}else{if(c.which==27&&b.length){b.hide();return false}else{return true}}})});function _getSize(c){if(!c){return 0}var b="px";if(c.lastIndexOf("%")>=0){b="%"}var a=parseInt(c,10);if(a<1){return 0}if(b=="%"&&a>100){a=100}return""+a+b}function _getBorderStyle(c,a,f){var b=c.value;b=b.replace(/^#/,"");if(!b){b="#FFFFFF"}else{b="#"+b}var e=a.value;if(!e){e="0px"}else{e=parseInt(e,10)+"px"}var d=f.options[f.selectedIndex].value;if(!d){d="solid"}var g=b+" "+e+" "+d;return g}function _getBGColorStyle(b){var a=b.replace(/^#/,"");if(!a){a="#FFFFFF"}else{a="#"+a}return a}function doApplyWidgetSize(g){if(selectedSizeWidget){if(g.widget_align.selectedIndex==1){setFloat(selectedSizeWidget,"right")}else{setFloat(selectedSizeWidget,"left")}var c=_getSize(g.width.value);if(c){selectedSizeWidget.style.width=c}var q=_getSize(g.height.value);if(q&&q!="100%"){selectedSizeWidget.style.height=q}else{selectedSizeWidget.style.height="";var p=xGetElementsByClassName("widgetBorder",selectedSizeWidget);for(var k=0;k<p.length;k++){var j=p[k];j.style.height=""}}selectedSizeWidget.style.borderTop=_getBorderStyle(g.border_top_color,g.border_top_thick,g.border_top_type);selectedSizeWidget.style.borderBottom=_getBorderStyle(g.border_bottom_color,g.border_bottom_thick,g.border_bottom_type);selectedSizeWidget.style.borderLeft=_getBorderStyle(g.border_left_color,g.border_left_thick,g.border_left_type);selectedSizeWidget.style.borderRight=_getBorderStyle(g.border_right_color,g.border_right_thick,g.border_right_type);selectedSizeWidget.style.marginTop=_getSize(g.margin_top.value);selectedSizeWidget.style.marginRight=_getSize(g.margin_right.value);selectedSizeWidget.style.marginBottom=_getSize(g.margin_bottom.value);selectedSizeWidget.style.marginLeft=_getSize(g.margin_left.value);if(!g.background_color.value||g.background_color.value=="transparent"){selectedSizeWidget.style.backgroundColor="transparent"}else{selectedSizeWidget.style.backgroundColor=_getBGColorStyle(g.background_color.value)}var m=g.background_image_url.value;if(m&&m!="none"){selectedSizeWidget.style.backgroundImage="url("+m+")"}else{selectedSizeWidget.style.backgroundImage="none"}switch(g.background_repeat.selectedIndex){case 1:selectedSizeWidget.style.backgroundRepeat="no-repeat";break;case 2:selectedSizeWidget.style.backgroundRepeat="repeat-x";break;case 3:selectedSizeWidget.style.backgroundRepeat="repeat-y";break;default:selectedSizeWidget.style.backgroundRepeat="repeat";break}selectedSizeWidget.style.backgroundPosition=g.background_x.value+" "+g.background_y.value;var a=selectedSizeWidget.firstChild;while(a){if(a.nodeName=="DIV"&&(a.className=="widgetBorder"||a.className=="widgetBoxBorder")){var n=a.firstChild;while(n){if(n.nodeName=="DIV"){n.style.padding="";var f=_getSize(g.padding_left.value);if(f){n.style.paddingLeft=f;selectedSizeWidget.setAttribute("widget_padding_left",f)}else{n.style.paddingLeft="";selectedSizeWidget.setAttribute("widget_padding_left","")}var e=_getSize(g.padding_right.value);if(e){n.style.paddingRight=e;selectedSizeWidget.setAttribute("widget_padding_right",e)}else{n.style.paddingRight="";selectedSizeWidget.setAttribute("widget_padding_right","")}var r=_getSize(g.padding_top.value);if(r){n.style.paddingTop=r;selectedSizeWidget.setAttribute("widget_padding_top",r)}else{n.style.paddingTop="";selectedSizeWidget.setAttribute("widget_padding_top","")}var d=_getSize(g.padding_bottom.value);if(d){n.style.paddingBottom=d;selectedSizeWidget.setAttribute("widget_padding_bottom",d)}else{n.style.paddingBottom="";selectedSizeWidget.setAttribute("widget_padding_bottom","")}break}n=n.nextSibling}break}a=a.nextSibling}selectedWidget=selectedSizeWidget;selectedSizeWidget=null;var l=selectedWidget.getAttribute("widget");var h=new Array();for(var k=0;k<selectedWidget.attributes.length;k++){if(!selectedWidget.attributes[k].nodeName||!selectedWidget.attributes[k].nodeValue){continue}var b=selectedWidget.attributes[k].nodeName.toLowerCase();if(b=="contenteditable"||b=="id"||b=="src"||b=="widget"||b=="body"||b=="class"||b=="widget_width"||b=="widget_width_type"||b=="xdpx"||b=="xdpy"||b=="height"){continue}var o=selectedWidget.attributes[k].nodeValue;if(!o||o=="Array"){continue}h[b]=o}h.style=getStyle(selectedWidget);h.selected_widget=l;h.module_srl=get_by_id("pageFo").module_srl.value;exec_xml("widget","procWidgetGenerateCodeInPage",h,function(i){doAddWidgetCode(i.widget_code)},new Array("error","message","widget_code","tpl","css_header"))}doHideWidgetSizeSetup()}var hideElements=new Array();function restoreWidgetButtons(){var d=get_by_id("widgetButton");var b=get_by_id("widgetBoxButton");if(!d||!b){return}d.style.visibility="hidden";get_by_id("zonePageContent").parentNode.appendChild(d);b.style.visibility="hidden";get_by_id("zonePageContent").parentNode.appendChild(b);for(var a=0;a<hideElements.length;a++){var c=hideElements[0];c.style.paddingTop=0}hideElements=new Array()}function showWidgetButton(a,b){var c=get_by_id(a);if(!c){return}c.style.visibility="visible";b.insertBefore(c,b.firstChild)}function widgetSetup(a){var d=new xEvent(a);var c=d.target;if(jQuery(c).is(".widgetButtons")||jQuery(c).parents(".widgetButtons").size()>0){return}if(jQuery(c).is(".buttonBox")||jQuery(c).parents(".buttonBox").size()>0){return}var f=jQuery(c).parents(".widgetOutput");if(f.size()==0){restoreWidgetButtons();return}c=f.get(0);var b=f.attr("widget");if(!b){return}if(b=="widgetBox"){restoreWidgetButtons();showWidgetButton("widgetBoxButton",c)}else{restoreWidgetButtons();showWidgetButton("widgetButton",c);var g=c.parentNode;if(g){while(g){if(g.nodeName=="DIV"&&g.getAttribute("widget")=="widgetBox"){showWidgetButton("widgetBoxButton",g);break}g=g.parentNode}}}}var widgetDragManager={obj:null,isDrag:false};var widgetTmpObject=new Array();var widgetDisappear=0;function widgetCreateTmpObject(a){var b=a.getAttribute("id");tmpObj=xCreateElement("DIV");tmpObj.id=b+"_tmp";tmpObj.className=a.className;tmpObj.style.overflow="hidden";tmpObj.style.margin="0px";tmpObj.style.padding="0px";tmpObj.style.width=a.style.width;tmpObj.style.display="none";tmpObj.style.position="absolute";tmpObj.style.opacity=1;tmpObj.style.filter="alpha(opacity=100)";xLeft(tmpObj,xPageX(a));xTop(tmpObj,xPageY(a));document.body.appendChild(tmpObj);widgetTmpObject[a.id]=tmpObj;return tmpObj}var idStep=0;function widgetGetTmpObject(a){if(!a.id){a.id="widget_"+idStep++}var b=widgetTmpObject[a.id];if(!b){b=widgetCreateTmpObject(a)}return b}function widgetDragEnable(b,c,d,a){b.draggable=true;b.dragStart=c;b.drag=d;b.dragEnd=a;if(!widgetDragManager.isDrag){widgetDragManager.isDrag=true;xAddEventListener(document,"mousemove",widgetDragMouseMove,false)}}function widgetDragStart(a,c,b){if(a.className=="widgetResize"||a.className=="widgetResizeLeft"||a.className=="widgetBoxResize"||a.className=="widgetBoxResizeLeft"){return}var d=widgetGetTmpObject(a);xInnerHtml(d,xInnerHtml(a));xLeft(d,xPageX(a));xTop(d,xPageY(a));xWidth(d,xWidth(a));xHeight(d,xHeight(a));xDisplay(d,"block")}function widgetDrag(z,j,h){var p=40;var e=10;var r=xPageX(z.parentNode);var q=xPageY(z.parentNode);var D=z.xDPX;var B=z.xDPY;var d=xWidth(zonePageObj);var m=xPageX(zonePageObj);var k=m+d;var u=xWidth(z.parentNode);var A=getFloat(z.parentNode);if(!A){A="left"}if(z.className=="widgetResize"||z.className=="widgetBoxResize"){if(D<r+p){D=r+p}if(D>k){D=k}if(A=="right"){D=r+u}var f=D-r;if(f<p){f=p}var F=B-q;if(F<e){F=e}if(k<r+f){f=k-r}xWidth(z.nextSibling.nextSibling,f);xHeight(z.nextSibling.nextSibling,F);xWidth(z.parentNode,f);xHeight(z.parentNode,F)}else{if(z.className=="widgetResizeLeft"||z.className=="widgetBoxResizeLeft"){if(D<m){D=m}if(A=="left"){D=r}var f=u+(r-D);if(f<p){f=p}var F=B-q;if(F<e){F=e}xWidth(z.nextSibling,f);xHeight(z.nextSibling,F);xWidth(z.parentNode,f);xHeight(z.parentNode,F)}else{var n=widgetGetTmpObject(z);xLeft(n,parseInt(xPageX(n),10)+parseInt(j,10));xTop(n,parseInt(xPageY(n),10)+parseInt(h,10));if(z.parentNode!=zonePageObj){var G=xGetElementsByClassName("widgetOutput",z.parentNode);for(var y=0;y<G.length;y++){var E=G[y];var v=xPageX(E);var o=xPageY(E);var g=parseInt(v,10)+parseInt(xWidth(E),10);var a=parseInt(o,10)+parseInt(xHeight(E),10);if(z!=E&&z.xDPX>=v&&z.xDPX<=g&&z.xDPY>=o&&z.xDPY<=a&&z.parentNode==E.parentNode){var x=E.nextSibling;if(!x){x=xCreateElement("DIV");E.parentNode.appendChild(x)}var w=z.nextSibling;if(!w){w=xCreateElement("DIV");z.parentNode.appendChild(w)}if(x){x.parentNode.insertBefore(z,x)}if(w){w.parentNode.insertBefore(E,w)}doFitBorderSize();G=null;return}}G=null;var b=jQuery(z).parents("div.nullWidget").get(0);var v=xPageX(b);var o=xPageY(b);var g=parseInt(v,10)+parseInt(xWidth(b),10);var a=parseInt(o,10)+parseInt(xHeight(b),10);if((z.xDPX<v||z.xDPX>g)||(z.xDPY<o||z.xDPY>a)){zonePageObj.insertBefore(z,jQuery(z).parents("div.widgetOutput[widget=widgetBox]").get(0));doFitBorderSize();return}}else{if(z.getAttribute("widget")!="widgetBox"){var C=xGetElementsByClassName("nullWidget",zonePageObj);for(var y=0;y<C.length;y++){var E=C[y];xHeight(E,xHeight(E.parentNode));xWidth(E,xWidth(E.parentNode));var v=xPageX(E);var o=xPageY(E);var g=parseInt(v,10)+parseInt(xWidth(E),10);var a=parseInt(o,10)+parseInt(xHeight(E),10);if(z.xDPX>=v&&z.xDPX<=g&&z.xDPY>=o&&z.xDPY<=a){if(E.className=="nullWidget"){var s=jQuery("div.widget_inner",jQuery(E));if(s.size()==0){E.appendChild(z)}else{s.get(0).appendChild(z)}widgetManualEnd();doFitBorderSize();C=null;return}}}C=null}var G=xGetElementsByClassName("widgetOutput",zonePageObj);for(var y=0;y<G.length;y++){var E=G[y];var c=E.getAttribute("widget");if(c=="widgetBox"||E.parentNode!=zonePageObj){continue}var v=xPageX(E);var o=xPageY(E);var g=parseInt(v,10)+parseInt(xWidth(E),10);var a=parseInt(o,10)+parseInt(xHeight(E),10);if(z!=E&&z.xDPX>=v&&z.xDPX<=g&&z.xDPY>=o&&z.xDPY<=a&&z.parentNode==E.parentNode){var x=E.nextSibling;if(!x){x=E.parentNode.lastChild}if(!x){x=xCreateElement("DIV");E.parentNode.appendChild(x)}var w=z.nextSibling;if(!w){w=xCreateElement("DIV");z.parentNode.appendChild(w)}if(x){x.parentNode.insertBefore(z,x)}if(w){w.parentNode.insertBefore(E,w)}doFitBorderSize();G=null;return}}G=null}}}}function widgetDragEnd(a,c,b){var d=widgetGetTmpObject(a);widgetDisapear=widgetDisapearObject(d,a);widgetDragDisable(a.getAttribute("id"))}function widgetDisapearObject(b,a){xInnerHtml(a,xInnerHtml(b));xInnerHtml(b,"");xDisplay(b,"none");b.parentNode.removeChild(b);widgetTmpObject[a.id]=null;return}function widgetMouseDown(c){var a=new xEvent(c);var b=a.target;while(b&&!b.draggable){b=xParent(b,true)}if(b){xPreventDefault(c);b.xDPX=a.pageX;b.xDPY=a.pageY;widgetDragManager.obj=b;xAddEventListener(document,"mouseup",widgetMouseUp,false);if(b.dragStart){b.dragStart(b,a.pageX,a.pageY)}}}function widgetMouseUp(b){if(widgetDragManager.obj){xPreventDefault(b);xRemoveEventListener(document,"mouseup",widgetMouseUp,false);if(widgetDragManager.obj.dragEnd){var a=new xEvent(b);widgetDragManager.obj.dragEnd(widgetDragManager.obj,a.pageX,a.pageY)}widgetDragManager.obj=null;widgetDragManager.isDrag=false}}function widgetDragMouseMove(f){var b=new xEvent(f);if(widgetDragManager.obj){xPreventDefault(f);var d=widgetDragManager.obj;var c=b.pageX-d.xDPX;var a=b.pageY-d.xDPY;d.xDPX=b.pageX;d.xDPY=b.pageY;if(d.drag){d.drag(d,c,a)}else{xMoveTo(d,xLeft(d)+c,xTop(d)+a)}}}function widgetDragDisable(b){if(!widgetDragManager){return}var a=get_by_id(b);a.draggable=false;a.dragStart=null;a.drag=null;a.dragEnd=null;xRemoveEventListener(a,"mousedown",widgetMouseDown,false);return}function widgetManualEnd(){var a=widgetDragManager.obj;if(!a){return}xRemoveEventListener(document,"mouseup",widgetMouseUp,false);xAddEventListener(document,"mousemove",widgetDragMouseMove,false);var b=widgetGetTmpObject(a);widgetDisapear=widgetDisapearObject(b,a);widgetDragDisable(a.getAttribute("id"));widgetDragManager.obj=null;widgetDragManager.isDrag=false};