<load target="js/member_admin.js" usecdn="true" />
<load target="js/krzip_search.js" usecdn="true" />
<!--%load_js_plugin("ui.datepicker")-->
<script type="text/javascript" >
    xe.lang.deleteProfileImage = '{$lang->msg_delete_extend_form}';
    xe.lang.deleteImageMark = '{$lang->msg_delete_extend_form}';
    xe.lang.deleteImageName = '{$lang->msg_delete_extend_form}';
</script>
<h1>{$lang->member_info}</h1>
<div class="xe-ui-title-separator">
    <hr/>
</div>

<div id="content" class="cleared">
    <div cond="$XE_VALIDATOR_MESSAGE" class="xe-ui-message {$XE_VALIDATOR_MESSAGE_TYPE} gradient cleared">
        <a href="#" style="float: right;" onclick="jQuery(this).parent().remove();return false;" class="xe-ui-button-gray gradient">Dismiss</a>
        <p>{$XE_VALIDATOR_MESSAGE}</p>
    </div>
    <div class="xe-ui-panel">
        <div class="xe-ui-panel-content cleared">
            <form action="./" class="form" ruleset="@{$oDriver->getAdminInsertRuleset()}" method="post" enctype="multipart/form-data">
                <input type="hidden" name="module" value="member" />
                <input type="hidden" name="act" value="procMemberAdminInsert" />
				<input type="hidden" name="driver" value="{$driver}" />
                <input type="hidden" name="member_srl" value="{$member_srl}" />
                <input type="hidden" name="success_return_url" value="{getUrl('act', $act, 'driver', $driver)}" cond="$member_srl" />
                <input type="hidden" name="success_return_url" value="{getUrl('act', 'dispMemberAdminList', 'driver', $driver)}" cond="!$member_srl" />
                <h2 cond="$member_srl">{$lang->msg_update_member}</h2>
                <h2 cond="!$member_srl">{$lang->msg_new_member}</h2>
				{$insertTpl}
                <p class="form-list">
                    <span class="desc">{$lang->allow_message}</span>
                    <block loop="$lang->allow_message_type=>$key,$val">
                        <input type="radio" name="allow_message" value="{$key}" checked="checked"|cond="$member_info->allow_message == $key || (!$member_info->member_srl && $key == 'Y')" id="allow_{$key}" /> <label for="allow_{$key}">{$val}</label>
                    </block>
                </p>
                <p class="form-list">
                    <span class="desc">{$lang->status}</span>
                    <input type="radio" name="denied" id="appoval" value="N" checked="checked"|cond="$member_info->denied != 'Y'" > <label for="appoval">{$lang->approval}</label>
                    <input type="radio" name="denied" id="deny" value="Y" checked="checked"|cond="$member_info->denied == 'Y'" > <label for="deny">{$lang->denied}</label>
                </p>
                <p class="form-list">
                    <label for="until" class="desc">{$lang->limit_date}</label>
                    <input type="hidden" name="limit_date" id="date_limit_date" value="{$member_info->limit_date}" />
                    <input type="text" class="inputDate xe-ui-panel-text" id="until" value="{zdate($member_info->limit_date,'Y-m-d',false)}" title="{$lang->about_limit_date}"/>
                    <a href="#" class="dateRemover xe-ui-button-gray">{$lang->cmd_delete}</a>
                </p>
                <p class="form-list">
                    <span class="desc">{$lang->is_admin}</span>
                    <input type="radio" name="is_admin" id="is_admin" value="Y" checked="checked"|cond="$member_info->is_admin == 'Y'" > <label for="is_admin">{$lang->cmd_yes}</label>
                    <input type="radio" name="is_admin" id="not_admin" value="N" checked="checked"|cond="$member_info->is_admin != 'Y'" > <label for="not_admin">{$lang->cmd_no}</label>
                </p>
                <p class="form-list">
                    <label for="description" class="desc">{$lang->description}</label>
                    <textarea name="description" id="description" cols="42" rows="5" class="xe-ui-panel-textarea" title="{$lang->about_member_description}">{htmlspecialchars($member_info->description)}</textarea>
                </p>
                <p class="form-list">
                    <span class="desc">{$lang->member_group}</span>
                    <!--@foreach($group_list as $key=>$val)-->
                        <input type="checkbox" name="group_srl_list[]" value="{$key}" id="group_{$key}" <!--@if($member_info->group_list[$key])-->checked="checked"<!--@end--> />
                        <label for="group_{$key}">{$val->title}</label>
                    <!--@end-->
                </p>
            </form>
        </div>
        <div class="xe-ui-panel-controller">
            <hr />
            <p class="center">
                <a href="#" onclick="jQuery('.form').submit();return false;" class="xe-ui-button-gray">{$lang->save}</a>
            </p>
        </div>
    </div>
</div>
<script type="text/javascript">
    (function($){
        $(function(){
            var option = { changeMonth: true, changeYear: true, gotoCurrent: false,yearRange:'-100:+10', dateFormat:'yy-mm-dd', onSelect:function(){
                    $(this).prev('input[type="hidden"]').val(this.value.replace(/-/g,""))}
            };
            $.extend(option,$.datepicker.regional['{$lang_type}']);
            $(".inputDate").datepicker(option);
            $(".dateRemover").click(function() {
                $(this).prevAll('input').val('');
                $(this).blur();
                return false;
            });
        });
    })(jQuery);
</script>
