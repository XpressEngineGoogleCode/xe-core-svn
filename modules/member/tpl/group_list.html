<load target="js/member_admin_group.js" usecdn="true" />
<script type="text/javascript" >
    xe.lang.groupDeleteMessage = '{$lang->msg_group_delete}';
    xe.lang.multilingual = '{$lang->cmd_set_multilingual}';
    xe.lang.modify = '{$lang->cmd_modify}';
    xe.lang.deleteMSG = '{$lang->cmd_delete}';
</script>
<style type="text/css">
    ._imageMarkButton img { max-height:16px }
    .filebox_item { border: 1px solid #ccc!important; padding: 2px; max-height: 16px; }
    .x .multiLangEdit input.vLang { width:120px }
    .x .multiLangEdit input.vLang.loading { padding-right:24px;width:100px;background:transparent url(../../admin/tpl/img/preLoader16.gif) no-repeat 96px center }
</style>

<h1>{$lang->member_group}</h1>
<div class="xe-ui-title-separator">
    <hr/>
</div>

<div id="content" class="cleared">
    <div cond="$XE_VALIDATOR_MESSAGE" class="xe-ui-message {$XE_VALIDATOR_MESSAGE_TYPE} gradient cleared">
        <a href="#" style="float: right;" onclick="jQuery(this).parent().remove();return false;" class="xe-ui-button-gray gradient">Dismiss</a>
        <p>{$XE_VALIDATOR_MESSAGE}</p>
    </div>
    <div class="xe-ui-panel">
        <div class="xe-ui-panel-content cleared">
            <form action="" class="form" method="post" ruleset="insertGroupConfig">
                <input type="hidden" name="module" value="member" />
                <input type="hidden" name="act" value="procMemberAdminGroupConfig" />
                <table cellpadding="0" cellspacing="0" class="sortable xe-ui-table">
                    <caption>
                        <p class="f-left">
                            <strong>{count($group_list)}</strong> {$lang->msg_groups_exist}
                        </p>
                        <p class="f-right">
                            {$lang->use_group_image_mark}:
                            <input type="radio" name="group_image_mark" id="yes" value="Y" checked="checked"|cond="$config->group_image_mark == 'Y'" /> <label for="yes">{$lang->cmd_yes}</label>
                            <input type="radio" name="group_image_mark" id="no" value="N" checked="checked"|cond="$config->group_image_mark != 'Y'" /> <label for="no">{$lang->cmd_no}</label>
                        </p>
                    </caption>
                    <thead>
                        <tr>
                            <th scope="col">{$lang->group_title}</th>
                            <th scope="col">{$lang->description}</th>
                            <th scope="col">
                                <div>
                                    {$lang->is_default}
                                </div>
                            </th>
                            <th scope="col" class="_imageMarkButton">{$lang->group_image_mark}</th>
                            <th scope="col">Delete</th>
                        </tr>
                    </thead>
                    <tbody class="uDrag _groupList">
                        <tr loop="$group_list=>$group_srl,$group_info">
                            <td class="multiLangEdit">
                                <div class="wrap">
                                    <a href="#" class="xe-ui-button-gray img dragBtn">
                                        <img src="{getFullURL('')}common/img/icon_move.png" title="Move this item"/>
                                    </a>
                                    <input type="hidden" name="group_srls[]" value="{$group_info->group_srl}" />
                                    <input type="hidden" name="group_titles[]" value="{htmlspecialchars($group_info->title)}" class="vLang"/>
                                    <input type="text" value="{$group_info->title}" class="vLang xe-ui-panel-text" />
                                    <span class="desc"><a href="#langEdit" class="tgAnchor editUserLang" data-effect="slide">{$lang->cmd_set_multilingual}</a></span>
                                </div>
                            </td>
                            <td class="center"><input type="text" name="descriptions[]" value="{$group_info->description}" style="width:240px" class="xe-ui-panel-text" /></td>
                            <td class="center"><input type="radio" name="defaultGroup" value="{$group_info->group_srl}" title="Default" checked="checked"|cond="$group_info->is_default=='Y'" /></td>
                            <td class="_imageMarkButton center">
                                <input type="hidden" name="image_marks[]" value="{$group_info->image_mark}" class="_imgMarkHidden" />
                                <img src="{$group_info->image_mark}" alt="{$group_info->title}" cond="$config->group_image_mark == 'Y' && $group_info->image_mark" />
                                <a href="#imageMark" class="modalAnchor _imageMark filebox">{$lang->cmd_modify}</a>
                            </td>
                            <td class="center button"><a href="#{$group_srl}" class="_deleteTD _deleteGroup xe-ui-button-gray" style="display:none"|cond="$group_info->is_default == 'Y'">{$lang->cmd_delete}</a></td>
                        </tr>
                        <tr style="display:none" class="_template">
                            <td class="multiLangEdit">
                                <div class="wrap">
                                    <button type="button" class="dragBtn">Move to</button>
                                    <input type="hidden" name="group_srls[]" value="new" disabled="disabled"/>
                                    <input type="hidden" name="group_titles[]" value=""  disabled="disabled" class="vLang" />
                                    <input type="text" value="" class="vLang" />
                                    <span class="desc"><a href="#langEdit" class="tgAnchor editUserLang">{$lang->cmd_set_multilingual}</a></span>
                                </div>
                            </td>
                            <td><input type="text" name="descriptions[]" value="" style="width:240px" disabled="disabled" /></td>
                            <td><input type="radio" name="defaultGroup" value="" title="Default" disabled="disabled" /></td>
                            <td class="_imageMarkButton center">
                                <input type="hidden" name="image_marks[]" value="" class="_imgMarkHidden" disabled="disabled" />
                                <a href="#imageMark" class="modalAnchor _imageMark">{$lang->cmd_modify}</a>
                            </td>
                            <td><div class="_deleteTD"><a href="#new" class="_deleteGroup xe-ui-button-gray">{$lang->cmd_delete}</a></div></td>
                        </tr>
                    </tbody>
                </table>
                <p class="f-right">
                    <a href="#" class="_addGroup xe-ui-button-gray">{$lang->cmd_add_group}</a>
                </p>

                <!-- Multilingual -->
                <div id="langEdit" class="langEdit tgContent">
                    <ul class="langList"></ul>
                    <div class="langInput">
                        <h2>{$lang->cmd_multilingual} <strong>{$lang->cmd_modify}</strong> | <a href="#langEdit">{$lang->cmd_insert}</a></h2>
                        <ul>
                            {@
                            /* move current language to the top */
                            $a = array($lang_type=>$lang_supported[$lang_type]);
                            unset($lang_supported[$lang_type]);
                            $lang_supported = array_merge($a, $lang_supported);
                            }
                            <li loop="$lang_supported=>$code,$name" class="{$code}">
                                <label for="{$code}_var1">{$name}</label>
                                <input type="text" value="" id="{$code}_var1" class="xe-ui-panel-text" />
                            </li>
                        </ul>
                        <div class="action">
                            <a href="#" onclick="jQuery('.form').submit();" class="xe-ui-button-gray">{$lang->use}</a>
                            <div class="btnArea">
                                <span class="btn small"><input type="submit" value="{$lang->use}|{$lang->use_after_save}" /></span>
                            </div>
                            <p><a href="{getUrl('act','dispModuleAdminLangcode')}" class="xe-ui-button-gray">{$lang->multilingual_manager}</a></p>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal" id="imageMark">
            <div class="fg portlet">
                <div class="_useImageMark" style="display:none">
                    <h2>{$lang->use_group_image_mark}</h2>
                    <input id="useImageMark" type="radio" name="useImageMark" value="Y" />
                    <label for="useImageMark">{$lang->use}</label>
                    <input id="noImageMark" type="radio" name="useImageMark" value="N" />
                    <label for="noImageMark">{$lang->notuse}</label>
                </div>
                <!--@if($fileBoxList)-->
                <div>
                    <h2>{$lang->usable_group_image_mark_list}</h2>
                    <div class="filebox_list">
                    </div>
                </div>
                <!--@end-->
                <h2>{$lang->add_group_image_mark}</h2>
                <a href="{getUrl('', 'module','admin', 'act', 'dispModuleAdminFileBox')}" target="_blank">{$lang->link_file_box}</a>
            </div>
        </div>
        <div class="xe-ui-panel-controller">
            <hr />
            <p class="center">
                <a href="#" onclick="jQuery('.form').submit(); return false;" class="xe-ui-button-gray">{$lang->cmd_save}</a>
            </p>
        </div>
    </div>
</div>