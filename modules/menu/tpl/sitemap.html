<script type="text/javascript">
xe.lang.confirm_delete = "{$lang->confirm_delete}";
</script>
<load target="./js/menu_admin.js" usecdn="true" />
<load target="../../admin/tpl/js/sitemap.js" usecdn="true" />
<load target="./js/sitemap.js" usecdn="true" />


<h1>{$lang->menu_gnb_sub['siteMap']}</h1>
<div class="xe-ui-title-separator">
    <hr/>
</div>

<div id="content" class="cleared">
    <div cond="$XE_VALIDATOR_MESSAGE" class="xe-ui-message {$XE_VALIDATOR_MESSAGE_TYPE} gradient cleared">
        <a href="#" style="float: right;" onclick="jQuery(this).parent().remove();return false;" class="xe-ui-button-gray gradient">Dismiss</a>
        <p>{$XE_VALIDATOR_MESSAGE}</p>
    </div>
    <div class="xe-ui-panel">
        <div class="xe-ui-panel-content cleared">
		<table class="xe-ui-form-table">
			<tbody>
				<!--@foreach($menu_list as $key=>$value)-->
				<tr>
					<td>
						{@$menuSrl = $value->menuSrl}
						<form class="portlet siteMap" id="menu_{$menuSrl}" method="post">
							<input type="hidden" name="module" value="{$module}" />
							<input type="hidden" name="act" value="procMenuAdminArrangeItem" />
							<input type="hidden" name="menu_srl" value="{$menuSrl}" />
							<input type="hidden" name="menu_item_srl" value="" />
							<input type="hidden" name="success_return_url" value="{getUrl('', 'module', 'admin', 'act', 'dispMenuAdminSiteMap')}" />
							<p>
								<label>{$lang->menu_name}({$lang->browser_title}): </label><input type="text" name="title" value="{$value->title}" />
								<a class="tgMenuList xe-ui-button-gray" style="float: right" href="#nav_{$key}" alt="{$lang->collapsing}/{$lang->expanding}">{$lang->collapsing}</a>
							</p>
							<ul class="lined" id="nav_{$key}" cond="count($value->menuItems->list > 0)" <!--@if($_COOKIE['sitemap_toggle_#nav_'.$key])-->style="display:none;"<!--@end-->>
								<block loop="$value->menuItems->list=>$key2,$value2">
									{@$item = $value2}
									<include target="sitemap.item.html" />
								</block>
							</ul>
							<p class="btnArea">
								<a href="#editMenu" class="modalAnchor _add xe-ui-button-gray">{$lang->add_menu}...</a>
								<a href="#" class="xe-ui-button-green" onclick="document.getElementById('menu_{$menuSrl}').submit();">{$lang->cmd_save}</a>
								<a class="xe-ui-button-red" href="#" onclick="if(confirmDelete()){ jQuery('#menu_{$menuSrl} input[name=act]').val('procMenuAdminDelete'); document.getElementById('menu_{$menuSrl}').submit();}">{$lang->cmd_delete}</a>
								<a href="#remakeCache" onclick="doReloadTreeMenu('{$menuSrl}'); return false;" class="xe-ui-button-gray">{$lang->cmd_remake_cache}</a>
							</p>
						</form>
					</td>
				</tr>
				<!--@end-->
			</tbody>
		</table>
               

        <form id="addNewSitemapForm" action="./" method="post" class="form">
            <input type="hidden" name="module" value="{$module}" />
            <input type="hidden" name="act" value="procMenuAdminInsert" />
            <input type="hidden" name="title" value="{$lang->untitle}" />
            <input type="hidden" name="success_return_url" value="{getUrl('', 'module', 'admin', 'act', 'dispMenuAdminSiteMap')}" />
        </form>
		
        <div class="modal" id="editMenu">
            <div class="fg">
                <form ruleset="insertMenuItem" id="editForm" action="./" method="post" enctype="multipart/form-data" class="form">
                    <input type="hidden" name="module" value="menu" />
                    <input type="hidden" name="act" value="procMenuAdminInsertItem" />
                    <input type="hidden" name="menu_srl" value="" />
                    <input type="hidden" name="menu_item_srl" value="{$menu_info->menu_srl}" />
                    <input type="hidden" name="parent_srl" value="{$menu_info->menu_srl}" />
                    <h2 class="h2"><span>{$lang->add_menu}</span><span>{$lang->edit_menu}</span></h2>
                    <table class="xe-ui-form-table">
                        <tr>
                            <td class="v-top"><p>{$lang->menu_name}({$lang->browser_title}) <em>*</em></p></td>
                            <td><p>
                                <div class="a multiLangEdit">
                                    <input type="hidden" class="vLang" name="menu_name_key" />
                                    <input type="text" class="vLang" id="name" name="menu_name" />
                                    <!-- Multilingual -->
                                    <div id="langEdit" class="langEdit tgContent">
                                        <ul class="langList"></ul>
                                        <div class="langInput">
                                            <h2>{$lang->multilingual} <strong>{$lang->cmd_modify}</strong> | <a href="#langEdit">{$lang->cmd_insert}</a></h2>
                                            <ul>
                                                {@
                                                    /* move current language to the top */
                                                    $a = array($lang_type=>$lang_supported[$lang_type]);
                                                    unset($lang_supported[$lang_type]);
                                                    $lang_supported = array_merge($a, $lang_supported);
                                                }
                                                <li loop="$lang_supported=>$code,$name" class="{$code}"><label for="{$code}_var1">{$name}</label> <input type="text" value="" id="{$code}_var1" /></li>
                                            </ul>
                                            <div class="action">
                                                <div class="btnArea">
                                                    <span class="btn small"><input type="submit" value="{$lang->use}|{$lang->use_after_save}" /></span>
                                                </div>
                                                <p><a href="{getUrl('act','dispModuleAdminLangcode')}">{$lang->multilingual_manager}</a></p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /Multilingual -->
                                    <p class="desc">
                                        <a href="#langEdit" class="editUserLang tgAnchor">{$lang->cmd_set_multilingual}</a>
                                    </p>
                                </div>
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td>{$lang->module_or_url} <em>*</em></td>
                            <td><p>
                                <input type="radio" name="cType" id="cModule" class="_typeCheck" value="CREATE" /> <label for="cModule">{$lang->create_module_in_menu}</label>
                                <input type="radio" name="cType" id="sModule" class="_typeCheck" value="SELECT" /> <label for="sModule">{$lang->select_module_in_menu}</label>
                                <input type="radio" name="cType" id="url" class="_typeCheck" value="URL" /> <label for="url">{$lang->menu_url}</label>
                                </p>
                            </td>
                        </tr>
                        <tr id="kindModule">
                            <td>{$lang->select_module_in_menu} <em>*</em></td>
                            <td><p>
                                <select style="width:290px" id="kModule" name="module_type" class="xe-ui-panel-select">
                                    <block loop="$module_list=>$key,$value">
                                        <optgroup label="{$lang->page}" cond="$key=='page'">
                                            <option value="ARTICLE">{$lang->page_type_name['ARTICLE']}</option>
                                            <option value="WIDGET">{$lang->page_type_name['WIDGET']}</option>
                                            <option value="OUTSIDE">{$lang->page_type_name['OUTSIDE']}</option>
                                        </optgroup>
                                        <option value="{$key}" cond="$key!='page'">{$value->title}</option>
                                    </block>
                                </select>
                                </p>
                            </td>
                        </tr>
                        <tr id="createModule">
                            <td><label for="cModule_id">{$lang->create_mid_in_menu} <em>*</em></label></td>
                            <td>
                                <p><input type="text" id="cModule_id" name="create_menu_url" /></p>
                            </td>
                        </tr>
                        <tr id="selectModule">
                            <td><label for="sModule_id">{$lang->select_mid_in_menu} <em>*</em></label></td>
                            <td><p>
                                <select style="width:290px" id="sModule_id" name="select_menu_url" class="xe-ui-panel-select">
                                </select>
                                </p>
                            </td>
                        </tr>
                        <tr id="insertUrl">
                            <td>{$lang->menu_url} <em>*</em></td>
                            <td>
                                <p><input type="text" id="link_url" name="menu_url" value="http://" /></p>
                            </td>
                        </tr>
                        <tr>
                            <td>{$lang->about_menu_open_window} <em>*</em></td>
                            <td><p>
                                <input type="radio" name="menu_open_window" id="self" value="N" /> <label for="self">{$lang->menu_self_window}</label>
                                <input type="radio" name="menu_open_window" id="blank" value="Y" /> <label for="blank">{$lang->menu_open_window}</label>
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td class="v-top"><p>{$lang->menu_img_btn}</p></td>
                            <td>    
                                <span id="normal_btn_preview"></span><br />
                                <input type="file" name="menu_normal_btn" id="menu_normal_btn" /> <label for="menu_normal_btn">{$lang->menu_normal_btn}</label><br />
                                <span id="hover_btn_preview"></span><br />
                                <input type="file" name="menu_hover_btn" id="menu_hover_btn" /> <label for="menu_hover_btn">{$lang->menu_hover_btn}</label><br />
                                <span id="active_btn_preview"></span><br />
                                <input type="file" name="menu_active_btn" id="menu_active_btn" /> <label for="menu_active_btn">{$lang->menu_active_btn}</label>
                            </td>
                        </tr>
                        <tr>
                            <td>{$lang->menu_group_srls}</td>
                            <td id="groupList">
                            	<p>
                                <block loop="$group_list=>$key,$value">
                                    <input type="checkbox" name="group_srls[]" id="group_srls_{$value->group_srl}" value="{$value->group_srl}" /> 
                                    <label for="group_srls_{$value->group_srl}">{$value->title}</label>
                                </block>
                                </p>
                            </td>
                        </tr>
                    </table>
					<hr />
	                <p class="center">
	                    <a class="xe-ui-button-gray" href="#" onclick="document.getElementById('editForm').submit();" />{$lang->cmd_save}</a>
	                </p>
                </form>
            </div> 
        </div>
    </div>
	<div class="modal" id="listManager">
        <form ruleset="emptyTrash" id="fo_list" action="./" method="post" class="fg form">
            <input type="hidden" name="module" value="trash" />
            <input type="hidden" name="act" value="procTrashAdminEmptyTrash" />
            <input type="hidden" name="page" value="{$page}" />
            <input type="hidden" name="is_all" value="false" />
            <input type="hidden" name="origin_module" value="{$origin_module}" />
                <h2 class="h2">{$lang->document_manager}</h2>
                <div class="table even">
                    <table width="100%" border="1" cellspacing="0" id="trashManageListTable" class="xe-ui-form-table">
                        <caption>{$lang->selected_document} <strong id="selectedTrashCount">0</strong></caption>
                      <thead>
                            <tr>
                                <th scope="col">{$lang->document}</th>
                                <th scope="col">{$lang->trash_nick_name}</th>
                                <th scope="col">{$lang->ipaddress}</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div class="btnArea">
                    <span class="btn"><button type="submit" name="is_all" value="false">{$lang->cmd_delete}</button></span>
                    <span class="btn"><button type="submit" name="act" value="procTrashAdminRestore">{$lang->cmd_restore}</button></span>
                </div>
        </form>
	</div>
    <div class="xe-ui-panel-controller">
		<hr />
		<p class="center">
			<a class="xe-ui-button-gray" href="#" onclick="document.getElementById('addNewSitemapForm').submit();">{$lang->add_new_sitemap}...</a>
		</p>
    </div>
    </div>
</div>